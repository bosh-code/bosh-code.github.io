<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="MinesweeperJS" name="description">
    <meta content="Ryan Bosher" name="author">
    <link href="/assets/img/favicons/favicon.ico" rel="icon">
    <title>MinesweeperJS</title>
    <!-- Bootstrap core CSS & JQuery-->
    <link href="/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Custom styles -->
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
    <script crossorigin="anonymous" src="https://kit.fontawesome.com/ae66a4a154.js"></script>
    <link href="/css/blog.css" rel="stylesheet">
    <link href="/css/dark.css" rel="stylesheet">
    <link href="/css/atom-one.css" rel="stylesheet">
</head>
<body>
<div class="container" id="top">
    <div id="header-placeholder"></div>
    <main class="container" id="main" role="main">
        <div class="blog-main m-2">
            <div class="blog-post">
                <div class="jumbotron p-md-4 mb-2 text-white rounded-5rem bg-dark">
                    <div class="col px-0">
                        <h2 class="blog-post-title">MinesweeperJS</h2>
                    </div>
                </div>
                <p class="blog-post-meta">May 3rd, 2021 by <a href="#main">Ryan</a></p>
                <p>Some sourcecode for my <code><a href="/minesweeper.html">minesweeper</a></code> game.
                </p>
                <hr>
                <section id="code">
                    <h3>HTML</h3>
                    <p>Made with Bootstrap to make it easy</p>
                    <pre><code class="language-html rounded-5rem">&#60;div class="row"&#62;
    &#60;div class="col m-2"&#62;
        &#60;div class="game-settings"&#62;
            &#60;div class="slider-container row my-3 mx-1 text-center"&#62;
                &#60;label class="col text-center" for="diff-slider"&#62;Difficulty&#60;/label&#62;
                &#60;div&#62;
                    &#60;input class="slider" id="diff-slider" max="3" min="1" type="range" value="1"&#62;
                &#60;/div&#62;
                &#60;p class="col" id="diff-label"&#62;&#60;/p&#62;
            &#60;/div&#62;
            &#60;div class="slider-container row my-3 mx-1 text-center"&#62;
                &#60;label class="col text-center" for="size-slider"&#62;Board size&#60;/label&#62;
                &#60;div&#62;
                    &#60;input class="slider" id="size-slider" max="3" min="1" type="range" value="1"&#62;
                &#60;/div&#62;
                &#60;p class="col" id="size-label"&#62;&#60;/p&#62;
            &#60;/div&#62;
            &#60;div class="button-container row my-3 mx-1"&#62;
                &#60;div class="col"&#62;
                    &#60;button class="btn btn-primary" id="resetButton" onclick="resetGame()"&#62;Reset&#60;/button&#62;
                &#60;/div&#62;
            &#60;/div&#62;
        &#60;/div&#62;
        &#60;p&#62;&#60;em&#62;This works on mobile, but I really don't recommend it&#60;/em&#62;&#60;/p&#62;
    &#60;/div&#62;
    &#60;div class="col m-2 board-container"&#62;
        &#60;div aria-label="board" class="board" data-long-press-delay="500" id="board"&#62;&#60;/div&#62;
    &#60;/div&#62;
&#60;/div&#62;
</code></pre>
                    <h3>Disabling selection & enabling long-press:</h3>
                    <p>Makes it more mobile friendly.</p>
                    <p>In <code>minesweeper.js</code></p>
                    <pre><code class="language-html rounded-5rem">&#60;!DOCTYPE html&#62;
&#60;html class="notSelectable" data-long-press-delay="500" lang="en"&#62;
&#60;head&#62;
...
</code></pre>
                    <pre><code class="language-javascript rounded-5rem">function startGame () {
  $('.notSelectable').disableSelection()
...</code></pre>
                    <pre><code class="language-javascript rounded-5rem">function manageListeners (state) {
  if (state) {
    document.addEventListener('click', checkForWin)
    document.addEventListener('contextmenu', checkForWin)
    document.addEventListener('long-press', checkForWin)
...</code></pre>
                    <p>In <code>lib.js</code></p>
                    <pre><code class="language-javascript rounded-5rem">function addListeners (boardNode) {
  for (let i = 0; i < boardNode.children.length; i++) {
    boardNode.children[i].addEventListener('click', showCell)
    boardNode.children[i].addEventListener('contextmenu', markCell)
    boardNode.children[i].addEventListener('long-press', markCell)
  }
}
...</code></pre>
                    <h3>Logic</h3>
                    <p>Checking for win & loose conditions</p>
                    <p>In <code>minesweeper.js</code></p>
                    <pre><code class="language-javascript rounded-5rem">function checkForWin () {
  if (!wonState) {
    for (let c of board.cells) {
      if (c.isMine && !c.isMarked) {
        return false
      } else if (!c.isMine && c.hidden) {
        return false
      }
    }
    endGame(true, 'You win!')
  }
}
...</code></pre>
                    <p>In <code>lib.js</code></p>
                    <pre><code class="language-javascript rounded-5rem">function showCell (evt) {
  var idx = getCellIndex(getRow(evt.target), getCol(evt.target))
  var cell = board.cells[idx]
  cell.hidden = false
  cell.isMarked = false
  evt.target.classList.remove('hidden')
  evt.target.classList.remove('marked')
  if (evt.target.classList.contains('mine')) {
    revealMines()
    removeListeners()
    endGame(false, 'You loose')
    return
  }
...</code></pre>
                    <p>Adding mines</p>
                    <p>The override method is used for testing, one mine is created in the top left corner.</p>
                    <p>In <code>minesweeper.js</code></p>
                    <pre><code class="language-javascript rounded-5rem">function addMinesOverride () {
  board.cells[0].isMine = true
  mineCount = 1
}

function addMines (difficulty) {
  for (let i = 0; i < difficulty; i++) {
    let randomCell = Math.floor(Math.random() * Math.pow(boardSize, 2))
    board.cells[randomCell].isMine = true
    ++mineCount
  }
}
...</code></pre>
                    <nav aria-label="pagination-buttons" class="blog-pagination">
                        <a class="btn btn-outline-secondary" href="/sprint-3/js-fundamentals.html">Older</a>
                        <a class="btn btn-outline-primary" href="/sprint-4/neuroplasticity.html">Newer</a>
                    </nav>
            </div>
        </div>
    </main>
</div>
<div id="footer-placeholder"></div>
<section id="scripts">
    <script src="/assets/js/vendor/popper.min.js"></script>
    <script src="/dist/js/bootstrap.min.js"></script>
    <script src="/assets/js/vendor/highlight.pack.js"></script>
    <script>
      hljs.initHighlightingOnLoad()
    </script>
    <script>
      $(function () {
        $('#header-placeholder').load('/src/components/header.html')
      })

    </script>
    <script>
      $(function () {
        $('#footer-placeholder').load('/src/components/footer.html')
      })

    </script>
</section>
</body>
</html>
